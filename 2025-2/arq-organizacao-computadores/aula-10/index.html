<!doctype html><html lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><title>Aula 10 - Pipeline de instruções</title><style>a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,body,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:'';content:none}table{border-collapse:collapse;border-spacing:0}</style><style>:root{--main-bg:#282828;--main-fg:#ebdbb2;--main-fg-20:#ebdbb266;--main-fg-40:#ebdbb2dd;--main-primary:#fe8019;--main-primary-20:#fe801966}body{font-family:-apple-system,BlinkMacSystemFont,avenir next,avenir,segoe ui,helvetica neue,Adwaita Sans,Cantarell,Ubuntu,roboto,noto,helvetica,arial,sans-serif;min-height:100vh;display:flex;justify-content:center;background-color:var(--main-bg);color:var(--main-fg);line-height:1.35}.content{width:100%;max-width:960px;margin:2rem 1rem}.title{font-size:2.986rem;color:var(--main-primary);font-weight:700}.subtitle{font-size:1.2rem;margin-bottom:.5rem;opacity:.5}.subtitle-2{font-size:1.44rem;margin-top:2rem;margin-bottom:.5rem;font-weight:700}.class-date{opacity:.35}a,a:visited{color:var(--main-fg);text-decoration:none}a:hover{text-decoration:underline}ol,ul{margin-left:1rem}ol+p,ul+p{margin-top:1rem}li{margin-bottom:.5rem}li::marker{opacity:.6}</style><style>.md h1{font-size:2.986rem;color:var(--main-primary);font-weight:700}.md h2{font-size:2.074rem;margin:.8em 0 .4em 0;border-bottom:2px solid var(--main-primary-20)}.md h3{display:inline-block;font-size:1.44rem;margin-bottom:.2em;border-bottom:2px solid var(--main-fg-20)}.md .subtitle{margin-bottom:2rem}.md a,.md a:visited{text-decoration:underline;text-decoration-color:var(--main-fg-20)}.md .mermaid{display:flex;justify-content:center;margin-bottom:1rem;border:none}.md .mermaid svg{background-color:var(--main-fg-40)}.md table,.md td,.md th{border:1px solid var(--main-fg-20)}.md td,.md th{padding:.1rem .2rem}.md th{font-weight:700}.md p{margin-bottom:1rem}.md table{margin:0 auto 1rem auto}.md em{font-style:italic}.md strong{font-weight:700}.md pre{padding:.1rem .2rem;border:1px solid var(--main-fg-20);font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace}.md img{max-width:100%;margin:1rem auto;display:block;padding:1rem;background-color:var(--main-fg-20)}.md .mono{font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace}</style><style>code[class*=language-],pre[class*=language-]{color:#ebdbb2;font-family:Consolas,Monaco,"Andale Mono",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{color:#fbf1c7;background:#7c6f64}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{color:#fbf1c7;background:#7c6f64}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#1d2021}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.prolog{color:#a89984}.token.atrule,.token.boolean,.token.delimiter,.token.important,.token.keyword,.token.selector{color:#fb4934}.token.attr-name,.token.operator,.token.punctuation{color:#a89984}.token.builtin,.token.doctype,.token.tag,.token.tag .punctuation{color:#fabd2f}.token.entity,.token.number,.token.symbol{color:#d3869b}.token.constant,.token.property,.token.variable{color:#fb4934}.token.char,.token.string{color:#b8bb26}.token.attr-value,.token.attr-value .punctuation{color:#a89984}.token.url{color:#b8bb26;text-decoration:underline}.token.function{color:#fabd2f}.token.regex{background:#b8bb26}.token.bold{font-weight:700}.token.italic{font-style:italic}.token.inserted{background:#a89984}.token.deleted{background:#fb4934}</style></head><body><div class="content md"><h1>Aula 10 - Pipeline de instruções</h1><p class="subtitle">27/10/2025</p><p>É possível obter um melhor desempenho tirando vantagem das melhorias da tecnologia. Uma forma de aprimorar esse desempenho é utilizando circuitos mais rápidos. Melhorias organizacionais no processador também podem melhorar a performance, como por exemplo usar mais registradores e o uso de uma memória cache maior. Outra abordagem organizacional é utilizar um pipeline de instruções.</p><p>O pipeline de instruções é uma ideia semelhante a uma linha de montagem ou de produção. A linha de montagem tira a vantagem do fato de que um produto passa por vários estágios de produção. Ao implantar esse processo, é possível trabalhar simultaneamente em diferentes instruções que estejam em diferentes estágios. De forma simplificada, os estágios de uma instrução são:</p><ul><li>Buscar: lê a próxima instrução da memória principal para o processador</li><li>Executar: interpreta o opcode e efetua a ação desejada</li><li>Interromper: se o sistema utiliza E/S controlada por interrupção, analisa se houve uma interrupção para atendê-la</li><li>Ciclo indireto: a busca de um operando na memória pode haver acessos adicionais, em que determinada posição de memória não possui o valor necessário, e sim outro endereço que deve ser buscado. É uma ideia similar ao uso de ponteiros.</li></ul><img loading="lazy" src="/aulas-fasec/_static/img/aula-10-est-instr-simples.png"><p>É possível quebrar esse ciclo de instruções em sub-etapas:</p><pre class="language-mermaid"><code class="language-mermaid">  <span class="token comment">%%{init: {'theme':'forest'}}%%</span>
  <span class="token keyword">flowchart</span> TD
    CE<span class="token string text">[Cálculo do endereço da instrução]</span> <span class="token arrow operator">--></span> BI
    BI<span class="token string text">[Busca da instrução]</span> <span class="token arrow operator">--></span> DO
    DO<span class="token string text">[Decodificação da operação da instrução]</span> <span class="token arrow operator">--></span> CO
    CO<span class="token string text">[Cálculo do endereço do operando]</span> <span class="token arrow operator">--></span> BO
    BO<span class="token string text">[Busca do operando]</span> <span class="token inter-arrow-label"><span class="token arrow operator arrow-head">--</span> <span class="token label property">Múltiplos operandos</span> <span class="token arrow operator">--></span></span> CO
    BO <span class="token inter-arrow-label"><span class="token arrow operator arrow-head">--</span> <span class="token label property">Indireção</span> <span class="token arrow operator">--></span></span> BO
    BO <span class="token arrow operator">--></span> OD
    OD<span class="token string text">[Operação dos dados]</span> <span class="token arrow operator">--></span> COO
    COO<span class="token string text">[Cálculo do endereço do operando]</span> <span class="token arrow operator">--></span> AO
    AO<span class="token string text">[Armazenar operando]</span> <span class="token inter-arrow-label"><span class="token arrow operator arrow-head">--</span> <span class="token label property">Múltiplos resultados</span> <span class="token arrow operator">--></span></span> COO
    AO <span class="token inter-arrow-label"><span class="token arrow operator arrow-head">--</span> <span class="token label property">Indireção</span> <span class="token arrow operator">--></span></span> AO
    AO <span class="token arrow operator">--></span> VI
    VI<span class="token string text">[Verificar interrupção]</span> <span class="token arrow operator">--></span> IT
    VI <span class="token inter-arrow-label"><span class="token arrow operator arrow-head">--</span> <span class="token label property">Sem interrupção</span> <span class="token arrow operator">--></span></span> CE
    IT<span class="token string text">[Interrupção]</span> <span class="token arrow operator">--></span> CE</code></pre><p>Essas sub-etapas acima são um fluxo complexo, e podemos simplificá-la para nosso pipeline em menos etapas. É possível, por exemplo, organizar o ciclo de instruções em seis sub-processos:</p><ul><li>Buscar instrução (BI): ler a próxima instrução esperada do programa</li><li>Decodificar instrução (DI): determinar o opcode e especificadores dos operandos</li><li>Calcular operandos (CO): calcular o endereço efetivo de cada operando de origem, contando inclusive com indireção</li><li>Obter operandos (OO): obter cada operando da memória para registradores</li><li>Executar instrução (EI): efetuar a operação indicada e armazenar o resultado</li><li>Escrever operando (EO): armazenar o resultado na memória</li></ul><p>Sem pipeline, a execução de instruções seriam mais ou menos desta forma (T1, T2, T3, ... indicam um clock):</p><div class="mono"><table><thead><tr><th></th><th>T1</th><th>T2</th><th>T3</th><th>T4</th><th>T5</th><th>T6</th><th>T7</th><th>T8</th><th>T9</th><th>T10</th><th>T11</th><th>T12</th><th>T13</th><th>T14</th></tr></thead><tbody><tr><td>Instrução 1</td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td>EI</td><td>EO</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Instrução 2</td><td></td><td></td><td></td><td></td><td></td><td></td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td>EI</td><td>EO</td><td></td><td></td></tr><tr><td>Instrução 3</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>BI</td><td>DI</td></tr></tbody></table></div><p>Utilizando a ideia de pipeline, a execução ficaria mais ou menos desta forma:</p><div class="mono"><table><thead><tr><th></th><th>T1</th><th>T2</th><th>T3</th><th>T4</th><th>T5</th><th>T6</th><th>T7</th><th>T8</th><th>T9</th><th>T10</th><th>T11</th><th>T12</th><th>T13</th><th>T14</th></tr></thead><tbody><tr><td>Instrução 1</td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td>EI</td><td>EO</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Instrução 2</td><td></td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td>EI</td><td>EO</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Instrução 3</td><td></td><td></td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td>EI</td><td>EO</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Instrução 4</td><td></td><td></td><td></td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td>EI</td><td>EO</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Instrução 5</td><td></td><td></td><td></td><td></td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td>EI</td><td>EO</td><td></td><td></td><td></td><td></td></tr><tr><td>Instrução 6</td><td></td><td></td><td></td><td></td><td></td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td>EI</td><td>EO</td><td></td><td></td><td></td></tr><tr><td>Instrução 7</td><td></td><td></td><td></td><td></td><td></td><td></td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td>EI</td><td>EO</td><td></td><td></td></tr><tr><td>Instrução 8</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td>EI</td><td>EO</td><td></td></tr><tr><td>Instrução 9</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td>EI</td><td>EO</td></tr></tbody></table></div><p>Desta forma, utilizamos mais do chip do processador. Vale ressaltar que em determinado tempo (coluna da nossa tabela acima), não há duas instruções no mesmo sub-processo.</p><h2>Hazard de pipeline</h2><p>Alguns fatores limitam o aumento de desempenho, e esses fatores são chamados de hazards de pipeline. Um hazard ocorre quando o pipeline, ou alguma parte dele, precisa parar porque as condições não permitem a execução contínua. Essa parada também é conhecida como bolha de pipeline. Existem três tipos de hazards: recursos, dados e controle.</p><h3>Hazard de recursos</h3><p>Ocorre quando duas ou mais instruções que já estão no pipeline dependem do mesmo recurso. O resultado é que as instruções precisam ser executadas em sequência ao invés de paralelo para uma parte do pipeline. Esse hazard também é chamado de estrutural.</p><p>Exemplo: suponha que haja uma operação lenta, que gaste mais tempo que o esperado na tarefa "Executar Instrução (EI)", as demais instruções que estão prontas para execução devem esperar até o recurso ser liberado:</p><div class="mono"><table><thead><tr><th></th><th>T1</th><th>T2</th><th>T3</th><th>T4</th><th>T5</th><th>T6</th><th>T7</th><th>T8</th><th>T9</th><th>T10</th><th>T11</th><th>T12</th><th>T13</th><th>T14</th></tr></thead><tbody><tr><td>Instrução 1</td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td>EI</td><td>EI</td><td>EI</td><td>EO</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Instrução 2</td><td></td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td></td><td></td><td>EI</td><td>EO</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Instrução 3</td><td></td><td></td><td>BI</td><td>DI</td><td>CO</td><td></td><td></td><td>OO</td><td>EI</td><td>EO</td><td></td><td></td><td></td><td></td></tr><tr><td>Instrução 4</td><td></td><td></td><td></td><td>BI</td><td>DI</td><td></td><td></td><td>CO</td><td>OO</td><td>EI</td><td>EO</td><td></td><td></td><td></td></tr></tbody></table></div><h3>Hazard de dados</h3><p>Ocorre quando há um conflito no acesso de uma posição de operando, isso é: duas instruções de um programa estão no pipeline e ambas acessam uma mesma posição de memória ou registrador. Se as instruções são executadas em um pipeline, é possível então que o valor seja utilizado na segunda operação antes do seu valor ser gravado na etapa de "Escrever Operando".</p><p>Exemplo:</p><div class="mono"><table><thead><tr><th></th><th>T1</th><th>T2</th><th>T3</th><th>T4</th><th>T5</th><th>T6</th><th>T7</th><th>T8</th><th>T9</th><th>T10</th><th>T11</th><th>T12</th><th>T13</th><th>T14</th></tr></thead><tbody><tr><td>Instrução 1</td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td>EI</td><td>E0</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Instrução 2</td><td></td><td>BI</td><td>DI</td><td></td><td></td><td></td><td>CO</td><td>OO</td><td>EI</td><td>EO</td><td></td><td></td><td></td><td></td></tr><tr><td>Instrução 3</td><td></td><td></td><td>BI</td><td></td><td></td><td></td><td>DI</td><td>CO</td><td>OO</td><td>EI</td><td>EO</td><td></td><td></td><td></td></tr><tr><td>Instrução 4</td><td></td><td></td><td></td><td></td><td></td><td></td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td>EI</td><td>EO</td><td></td><td></td></tr></tbody></table></div><h3>Hazard de controle</h3><p>Ocorre quando um pipeline toma uma decisão errada ao prever um desvio (if-else ou for) e acaba trazendo instruções para o pipeline que precisam ser descartadas</p><p>Exemplo:</p><div class="mono"><table><thead><tr><th></th><th>T1</th><th>T2</th><th>T3</th><th>T4</th><th>T5</th><th>T6</th><th>T7</th><th>T8</th><th>T9</th><th>T10</th><th>T11</th><th>T12</th><th>T13</th><th>T14</th></tr></thead><tbody><tr><td>Instrução 1</td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td>EI</td><td>EO</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Instrução 2</td><td></td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td>EI</td><td>EO</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Instrução 3</td><td></td><td></td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Instrução 4</td><td></td><td></td><td></td><td>BI</td><td>DI</td><td>CO</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Instrução 5</td><td></td><td></td><td></td><td></td><td>BI</td><td>DI</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Instrução 6</td><td></td><td></td><td></td><td></td><td></td><td>BI</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Instrução 7</td><td></td><td></td><td></td><td></td><td></td><td></td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td>EI</td><td>EO</td><td></td><td></td></tr><tr><td>Instrução 8</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td>EI</td><td>EO</td><td></td></tr><tr><td>Instrução 9</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>BI</td><td>DI</td><td>CO</td><td>OO</td><td>EI</td><td>EO</td></tr></tbody></table></div><script async type="module">import mermaid from"https://unpkg.com/mermaid@10/dist/mermaid.esm.min.mjs";document.addEventListener("DOMContentLoaded",mermaid.initialize({loadOnSave:!0}))</script></div></body></html>